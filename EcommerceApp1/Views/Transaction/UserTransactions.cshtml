@using EcommerceApp1.Helpers.Enums.Refunds;
@model UserTransactionsViewModel

<table class="table table-striped table-dark">
    <tr>
        <th>TransactionID</th>
        <th>Total</th>
        <th>Email</th>
        <th>PhoneNumber</th>
        <th>TransactionDate</th>
        <th>QuantityBought</th>
        <th>Product Name</th>
        <th>PaymentType</th>
    </tr>

    @foreach(var transaction in @Model.UserTransactions)
    {
        Refund requestedRefund = Model.GetUserRefundRequest(transaction.ID);
        <tr>
            <td>@transaction.ID</td>
            <td>@transaction.Total</td>
            <td>@transaction.Email</td>
            <td>@transaction.PhoneNumber</td>
            <td>@transaction.TransactionDate</td>
            <td>@transaction.QuantityBought</td>
            <td>@transaction.CurrentProduct.Name</td>
            <td>@transaction.PaymentType</td>

            @if(requestedRefund == null)
            {
                <td><a class="btn btn-danger" href="@Url.Action("Create", "Refund", new {transactionID = transaction.ID, productID = transaction.ProductID})">Refund</a></td>
            }
            else if (requestedRefund.Status == RefundStatus.Accepted.ToString())
            {
                <td>Refunded</td>
            }
        </tr>
    }
</table>
